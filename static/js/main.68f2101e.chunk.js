(this.webpackJsonpnetwork_performance=this.webpackJsonpnetwork_performance||[]).push([[0],{38:function(e,t,n){e.exports=n(52)},43:function(e,t,n){},50:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(27),i=n.n(s);n(43),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(44);var c=n(7),o=n(6),u=n(9),l=n(10),h=n(14),p=n(20),m=n(16),d=(a.Component,n(2)),f=n.n(d),_=n(8),b=(a.Component,a.Component,n(36)),v=n.n(b),y=(n(50),a.Component,n(12)),g=n(15),E=n(21),k=n.n(E),w=n(22),O=n.n(w),x=(a.Component,n(25)),j=(a.Component,function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,null,[{key:"CONFIG",get:function(){return"cloudflare"}},{key:"PING_INTERVAL",get:function(){return 100}}]),e}()),C=n(17),z=n(28),T=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"run",value:function(){console.log("running this scenario: ".concat(this.constructor.name))}},{key:"pause",value:function(){console.log("pausing this scenario: ".concat(this.constructor.name))}}]),e}(),P=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a,r,s){var i;return Object(c.a)(this,n),(i=t.call(this)).num_measurements=e,i.file_size=a,i.counter=0,i.reset_controller(),i.result_callback=s,i.num_streams=r,i}return Object(o.a)(n,null,[{key:"BASE_URL",get:function(){return"arshan"===j.CONFIG?"https://worker.arshankhanifar.workers.dev":"https://speed.cloudflare.com"}}]),Object(o.a)(n,[{key:"reset_controller",value:function(){this.controller=new AbortController}},{key:"run",value:function(){var e=Object(_.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(z.a)(Object(C.a)(n.prototype),"run",this).call(this);case 1:if(!(this.counter<this.num_measurements)){e.next=16;break}return e.prev=2,e.next=5,this.measure();case 5:t=e.sent,this.result_callback&&this.result_callback(t),e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(2),console.log("download: ".concat(this.counter," was cancelled"),e.t0),e.abrupt("return",!1);case 13:this.counter+=1,e.next=1;break;case 16:return e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){Object(z.a)(Object(C.a)(n.prototype),"pause",this).call(this),this.controller.abort(),this.reset_controller()}},{key:"convert_to_mbps",value:function(e){return 1e3*e/(1<<20)*8}},{key:"measure",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(T),S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).type="Download",e}return Object(o.a)(n,null,[{key:"TYPE",get:function(){return"Download"}}]),Object(o.a)(n,[{key:"measure",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.download());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"download",value:function(){var e=Object(_.a)(f.a.mark((function e(){var t,a,r,s,i,c=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.num_streams,a="".concat(P.BASE_URL,"/").concat(n.DOWN_ENDPOINT),r=this.controller.signal,s=Array(t).fill(0).map((function(e){return new Object})).map((function(e){return e.start=Date.now(),e.fetch=fetch("".concat(a,"?bytes=").concat(c.file_size),{signal:r}),e})),e.next=6,Promise.all(s.map((function(e){return e.fetch.then((function(t){return t.text().then((function(t){e.finish=Date.now()}))}))})));case 6:return i=s.map((function(e){return c.file_size/(e.finish-e.start)})),e.abrupt("return",this.convert_to_mbps(i.reduce((function(e,t){return e+t}))));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"DOWN_ENDPOINT",get:function(){return"arshan"===j.CONFIG?"/hello/down":"__down"}}]),n}(P),D=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).duration=e,a.last_start=null,a.type="Wait",a.started=!1,a}return Object(o.a)(n,null,[{key:"TYPE",get:function(){return"Wait"}}]),Object(o.a)(n,[{key:"wait",value:function(){var e=Object(_.a)(f.a.mark((function e(t){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.resolver=e,n.last_start=Date.now(),n.timer=setTimeout((function(){e(!0)}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(z.a)(Object(C.a)(n.prototype),"run",this).call(this),this.started||(this.amount_remaining=this.duration,this.started=!0),e.next=4,this.wait(this.amount_remaining);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){Object(z.a)(Object(C.a)(n.prototype),"pause",this).call(this),clearTimeout(this.timer),this.amount_remaining-=Date.now()-this.last_start,console.log("paused, amount remaining: ".concat(this.amount_remaining)),this.resolver(!1)}}]),n}(T),A=(a.Component,n(30)),F=n(18),B=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,null,[{key:"get_colour",value:function(e){var t=this.DEFAULT_COLOURS.length;e in this.mapping||(this.mapping[e]=this.count,this.count+=1);var n=this.mapping[e];return this.DEFAULT_COLOURS[n%t]}}]),e}();B.DEFAULT_COLOURS=["#0d233a","#2f7ed8","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],B.mapping={},B.count=0;var I=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).chart_options={chart:{zoomType:"x",animation:{duration:100}},title:{text:"Latency"},subtitle:{text:void 0===document.ontouchstart?"Click and drag in the plot area to zoom in":"Pinch the chart to zoom in"},xAxis:{type:"datetime"},yAxis:{title:{text:"Ping(ms)"},gridLineWidth:0},legend:{enabled:!1},plotOptions:{area:{marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},series:[]},a.series_lookup={},a.chartComponent=r.a.createRef(),a}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{ref:this.chartComponent,highcharts:k.a,options:this.chart_options}),r.a.createElement("br",null))}},{key:"get_series",value:function(e,t){var n=this.chartComponent.current.chart;return e in this.series_lookup||(this.series_lookup[e]=Object.keys(this.series_lookup).length,n.addSeries({type:"area",name:"latency",data:[],color:t?B.get_colour(e):"rgb(120,120,120)"})),n.series[this.series_lookup[e]]}},{key:"add_point",value:function(e,t,n){this.get_series(t,n).addPoint([Date.now(),e])}}]),n}(a.Component),N=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).chart_options={chart:{type:"scatter",height:100},tooltip:{headerFormat:"",pointFormat:"{series.name}: <b>{point.x}</b><br/>"},xAxis:{tickInterval:5,categories:[]},title:{floating:!0,text:""},yAxis:{width:0,min:.7,max:1.8,gridLineWidth:0,tickAmount:1,title:{reserveSpace:!1,text:"",rotation:0,x:40,y:-15},labels:{enabled:!1}},legend:{enabled:!1},plotOptions:{series:{stacking:"normal"}},series:[{name:"Download Speed",data:[],color:"red"}]},a.chartComponent=r.a.createRef(),a.chart_options.series[0]={name:a.props.series_name,data:[],color:B.get_colour(a.props.color_id)},a}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,null,r.a.createElement(x.a.Body,null,r.a.createElement(x.a.Title,null,this.props.title),r.a.createElement(O.a,{ref:this.chartComponent,highcharts:k.a,options:this.chart_options}))))}},{key:"componentDidUpdate",value:function(e,t,n){if(e.data){var a=e.data.slice(-1).pop();if(a){var r=this.chartComponent.current.chart;r.series[0].data.length!==e.data.length&&r.series[0].addPoint([parseFloat(a.rate.toFixed(2)),1])}}}}]),n}(a.Component),U=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).type="Upload",e}return Object(o.a)(n,null,[{key:"TYPE",get:function(){return"Upload"}}]),Object(o.a)(n,[{key:"measure",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upload());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(_.a)(f.a.mark((function e(){var t,a,r,s,i,c=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.num_streams,a="".concat(P.BASE_URL,"/").concat(n.UP_ENDPOINT),r=this.controller.signal,s=Array(t).fill(0).map((function(e){return new Object})).map((function(e){return e.start=Date.now(),e.fetch=fetch("".concat(a),Object(A.a)({},{method:"POST",body:"0".repeat(c.file_size),headers:{"content-length":c.file_size}},{signal:r})),e})),e.next=6,Promise.all(s.map((function(e){return e.fetch.then((function(t){return t.text().then((function(t){e.finish=Date.now()}))}))})));case 6:return i=s.map((function(e){return c.file_size/(e.finish-e.start)})),e.abrupt("return",this.convert_to_mbps(i.reduce((function(e,t){return e+t}))));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"UP_ENDPOINT",get:function(){return"arshan"===j.CONFIG?"/hello/up":"__up"}}]),n}(P),L=n(37),Y=n(19),W=n(24),R=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={scenarios:a.normalize_scenarios(e.scenarios)},a.scenario_types=[S.TYPE,U.TYPE,D.TYPE],a}return Object(o.a)(n,[{key:"edit",value:function(){var e=Object(_.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!this.state.scenarios[t.id].editing,this.state.scenarios[t.id].editing=n,e.next=4,this.sync_table();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sync_table",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({scenarios:this.state.scenarios});case 2:return e.next=4,this.props.table_updated(this.state.scenarios);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.scenarios.push(this.normalize_scenario(new S(20,1<<17,1,null))),this.reindex_scenarios(),e.next=4,this.sync_table();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"type_changed",value:function(){var e=Object(_.a)(f.a.mark((function e(t,n){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},Object(F.a)(a,D.TYPE,D),Object(F.a)(a,S.TYPE,S),Object(F.a)(a,U.TYPE,U),(r=new a[n.target.value]).num_measurements=t.num_measurements||0,r.num_streams=t.num_streams||0,r.file_size=t.file_size||0,(r=this.normalize_scenario(r)).editing=!0,this.state.scenarios[t.id]=r,e.next=10,this.reindex_scenarios();case 10:return e.next=12,this.sync_table();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete_row",value:function(){var e=Object(_.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("scenario id",t.id),this.state.scenarios=this.state.scenarios.filter((function(e,n){return n!==t.id})),this.reindex_scenarios(),e.next=5,this.sync_table();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reindex_scenarios",value:function(){var e=0;this.setState({scenarios:this.state.scenarios.map((function(t){return t.id=e++,t}))})}}]),Object(o.a)(n,[{key:"normalize_scenario",value:function(e){var t=e.file_size;return e.size_formatted=e.type===D.TYPE?{value:0,postfix:"B"}:this.get_formatted_measurement(t),this.update_size(e),e}},{key:"normalize_scenarios",value:function(e){var t=this;return e.map((function(e){return t.normalize_scenario(e)}))}},{key:"get_formatted_measurement",value:function(e){return 0!==Math.floor(e/(1<<20))?{value:e/(1<<20),postfix:"MB"}:Math.floor(e/1024!==0)?{value:e/1024,postfix:"KB"}:{value:e,postfix:"B"}}},{key:"update_size",value:function(e){e.label="".concat(e.size_formatted.value).concat(e.size_formatted.postfix),e.file_size={KB:1024,MB:1<<20,B:1}[e.size_formatted.postfix]*e.size_formatted.value}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(L.a,{striped:!0,bordered:!0,responsive:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Type"),r.a.createElement("th",null,"# Bytes"),r.a.createElement("th",null,"# Measurements"),r.a.createElement("th",null,"# Streams"),r.a.createElement("th",null,"Delete"))),r.a.createElement("tbody",null,this.state.scenarios.map((function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,t.id+1),t.editing?r.a.createElement(r.a.Fragment,null,r.a.createElement("td",null,r.a.createElement(Y.a.Group,{controlId:"scenarioType"},r.a.createElement(Y.a.Control,{as:"select",defaultValue:t.type,onChange:function(n){e.type_changed(t,n)}},e.scenario_types.map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))))),"Wait"===t.type?r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{colSpan:3},r.a.createElement(W.a,null,r.a.createElement(Y.a.Control,{type:"number",placeholder:"Wait amount (in milliseconds)","aria-describedby":"waitAmount",name:"size",onChange:function(e){t.duration=parseInt(e.target.value)},defaultValue:t.duration}),r.a.createElement(W.a.Append,null,r.a.createElement(W.a.Text,null,"ms"))))):r.a.createElement(r.a.Fragment,null,r.a.createElement("td",null,r.a.createElement(Y.a.Group,{controlId:"size",style:{width:170}},r.a.createElement(W.a,null,r.a.createElement(Y.a.Control,{type:"number",placeholder:"Size",name:"size",defaultValue:t.size_formatted.value,onChange:function(n){t.size_formatted.value=n.target.value,e.update_size(t)}}),r.a.createElement(W.a.Append,null,r.a.createElement(Y.a.Control,{as:"select",defaultValue:t.size_formatted.postfix,onChange:function(n){t.size_formatted.postfix=n.target.value,e.update_size(t)}},["B","KB","MB"].map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))))))),r.a.createElement("td",null,r.a.createElement(Y.a.Group,{style:{width:100}},r.a.createElement(W.a,null,r.a.createElement(Y.a.Control,{type:"number","aria-describedby":"numberOfMeasurements",name:"num_measurements",defaultValue:t.num_measurements,onChange:function(e){t.num_measurements=parseInt(e.target.value)}})))),r.a.createElement("td",null,r.a.createElement(Y.a.Group,{style:{width:100}},r.a.createElement(W.a,null,r.a.createElement(Y.a.Control,{type:"number","aria-describedby":"numberOfStreams",name:"num_streams",defaultValue:t.num_streams,onChange:function(e){t.num_streams=parseInt(e.target.value)}})))))):r.a.createElement(r.a.Fragment,null,"Wait"===t.type?r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{colSpan:4},"".concat(t.type," ").concat(t.duration,"ms"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("td",null,t.type),r.a.createElement("td",null,"".concat(t.size_formatted.value," ").concat(t.size_formatted.postfix)),r.a.createElement("td",null,t.num_measurements),r.a.createElement("td",null,t.num_streams))),r.a.createElement("td",null,r.a.createElement(g.a,{variant:"success",size:"sm",type:"submit",onClick:function(){e.edit(t)}},t.editing?"Done":"Edit")," ",r.a.createElement(g.a,{variant:"danger",size:"sm",onClick:function(){e.delete_row(t)}},"Delete")))})))),r.a.createElement(g.a,{variant:"success",onClick:this.add.bind(this)},"Add Row"))}}]),n}(a.Component),M="download_measurements",G="upload_measurements",V=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state=a.reset_values(),a.ping_timer=null,a.populate_scenarios(),a.ping_chart=r.a.createRef(),a}return Object(o.a)(n,[{key:"reset_values",value:function(){var e;return e={started:!1,paused:!0,current_idx:0},Object(F.a)(e,M,{}),Object(F.a)(e,G,{}),e}}]),Object(o.a)(n,[{key:"populate_scenarios",value:function(){this.state.scenarios=[new D(500),new S(20,1<<17,1,this.collect_bandwidth_data.bind(this)),new S(20,1<<20,1,this.collect_bandwidth_data.bind(this)),new S(20,10485760,1,this.collect_bandwidth_data.bind(this)),new D(500),new U(20,1<<17,1,this.collect_bandwidth_data.bind(this)),new D(500),new U(20,1<<20,1,this.collect_bandwidth_data.bind(this)),new U(20,10485760,1,this.collect_bandwidth_data.bind(this)),new D(500)],this.reindex_scenarios()}},{key:"reindex_scenarios",value:function(){var e=0;this.state.scenarios=this.state.scenarios.map((function(t){return t.id=e++,t}))}},{key:"table_updated",value:function(){var e=Object(_.a)(f.a.mark((function e(t){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({scenarios:t.map((function(e){return e.type!==D.TYPE&&(e.result_callback=n.collect_bandwidth_data.bind(n)),e}))});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{bg:"light"},r.a.createElement(h.a.Brand,{href:"#"},"KNP")),r.a.createElement(p.a,null,r.a.createElement(m.a,null,r.a.createElement(y.a,{lg:12},r.a.createElement("h1",null,"The Khanifar Bufferbloat Test"),r.a.createElement("p",null,"Best buffer bloat test in the history of mankind, ever\u2122")),r.a.createElement(y.a,{lg:12},r.a.createElement("h2",null,"Create a scenario"),r.a.createElement(R,{scenarios:this.state.scenarios,table_updated:this.table_updated.bind(this)})),r.a.createElement(y.a,{lg:12},r.a.createElement(I,{ref:this.ping_chart})),r.a.createElement(y.a,{lg:12},r.a.createElement(g.a,{onClick:this.test_control.bind(this)},this.state.started?this.state.paused?"Continue":"Pause":"Start")," "," "),r.a.createElement(y.a,{xs:12,md:6},r.a.createElement("span",null,r.a.createElement("strong",null,"Download"))),r.a.createElement(y.a,{xs:12,md:6},r.a.createElement("span",null,r.a.createElement("strong",null,"Upload"))),r.a.createElement(y.a,{xs:6,md:4},r.a.createElement("span",null,r.a.createElement("strong",null,"latency:")," ",this.state.latest_measurement),r.a.createElement("br",null),r.a.createElement("span",null,r.a.createElement("strong",null,"bw:")," ",this.state.latest_bw_measurement,"Mbps"))),r.a.createElement(m.a,null,r.a.createElement(y.a,{xs:12,md:6},r.a.createElement("span",null,r.a.createElement("strong",null,"Download Measurements")),Object.keys(this.state[M]).map((function(t){return r.a.createElement(N,{key:t,data:e.state[M][t],series_name:"Download",color_id:t,title:e.format_title(e.state[M][t],"Download")})}))),r.a.createElement(y.a,{xs:12,md:6},r.a.createElement("span",null,r.a.createElement("strong",null,"Upload Measurements")),Object.keys(this.state[G]).map((function(t){return r.a.createElement(N,{key:t,data:e.state[G][t],series_name:"Upload",color_id:t,title:e.format_title(e.state[G][t],"Upload")})}))))))}},{key:"format_title",value:function(e,t){return 0===e.length?"Loading...":"".concat(e[0].label," ").concat(t,": (").concat(e.length,"/").concat(e[0].num_measurements,")")}},{key:"check_if_started_and_toggle_pause",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.started){e.next=5;break}return e.next=3,this.setState({started:!0,paused:!1});case 3:e.next=7;break;case 5:return e.next=7,this.setState({paused:!this.state.paused});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"test_control",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.check_if_started_and_toggle_pause();case 2:this.state.paused?(this.current_scenario&&this.current_scenario.pause(),this.cancel_ping()):this.run_scenarios();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"run_scenarios",value:function(){var e=Object(_.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.current_idx!==this.state.scenarios.length){e.next=3;break}return console.log("Scenarios exhausted"),e.abrupt("return");case 3:this.ping(j.PING_INTERVAL),this.current_scenario=this.state.scenarios[this.state.current_idx];case 5:return e.next=7,this.current_scenario.run();case 7:if(!e.sent){e.next=17;break}return e.next=10,this.setState({current_idx:this.state.current_idx+1});case 10:if(this.state.current_idx!==this.state.scenarios.length){e.next=14;break}return console.log("Scenarios finished"),this.cancel_ping(),e.abrupt("return");case 14:this.current_scenario=this.state.scenarios[this.state.current_idx],e.next=5;break;case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"collect_bandwidth_data",value:function(){var e=Object(_.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.current_scenario.type!==D.TYPE){e.next=3;break}return console.error("Received rate from a WaitScenario",t),e.abrupt("return");case 3:return e.next=5,this.ensure_entry_exists();case 5:return n=this.current_scenario,a=n.type===S.TYPE?M:G,this.state[a][n.id].push(Object(A.a)({},n,{rate:t})),e.next=10,this.setState(Object(F.a)({},a,this.state[a]));case 10:console.log("received download data",t);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"ensure_entry_exists",value:function(){var e=Object(_.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.current_scenario,n=t.type===S.TYPE?M:G,t.id in this.state[n]){e.next=6;break}return this.state[n][t.id]=[],e.next=6,this.setState(Object(F.a)({},n,this.state[n]));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"collect_latency",value:function(e){this.state.paused?console.warn("Skipping latency Measurement cuz paused..."):(console.log("latency",e),this.setState({latest_measurement:e}),this.ping_chart.current.add_point(e,this.current_scenario.id,this.current_scenario.type!==D.TYPE))}},{key:"ping",value:function(){var e=Object(_.a)(f.a.mark((function e(t){var n,a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Date.now(),fetch("https://api.github.com/users/arshankhanifar").then((function(e){return e.json()})).then(function(){var e=Object(_.a)(f.a.mark((function e(t){var r,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Date.now(),s=r-n,a.collect_latency(s);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.ping_timer=setTimeout((function(){return a.ping(t)}),t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cancel_ping",value:function(){clearTimeout(this.ping_timer),this.ping_timer=null}}]),n}(a.Component);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.68f2101e.chunk.js.map