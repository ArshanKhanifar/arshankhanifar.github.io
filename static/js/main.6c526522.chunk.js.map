{"version":3,"sources":["serviceWorker.js","samples/hello_world_sample.js","samples/multiple_urls_sample.js","samples/single_stream_sample.js","samples/ping_sample.js","samples/highcharts_sample.js","config.js","samples/download_speed_chart_sample.js","scenarios/scenario.js","scenarios/bandwidth_scenario.js","scenarios/download_scenario.js","scenarios/wait_scenario.js","samples/scenario_sample.js","utilities/colours.js","components/ping_chart.js","components/bandwidth_chart.js","scenarios/upload_scenario.js","components/scenario_table.js","app.js","index.js"],"names":["Boolean","window","location","hostname","match","Component","AppConfiguration","Scenario","console","log","this","constructor","name","BandwidthScenario","num_measurements","file_size","num_streams","result_cb","counter","reset_controller","result_callback","CONFIG","controller","AbortController","measure","rate","abort","r","DownloadScenario","options","type","download","streams","url","BASE_URL","DOWN_ENDPOINT","signal","requests","Array","fill","map","Object","req","start","Date","now","fetch","Promise","all","then","res","text","t","finish","rates","convert_to_mbps","reduce","a","b","WaitScenario","duration","last_start","started","time_ms","resolve","resolver","timer","setTimeout","amount_remaining","wait","clearTimeout","ColourProvider","id","num_colours","DEFAULT_COLOURS","length","mapping","count","index","PingChart","props","chart_options","chart","zoomType","animation","title","subtitle","undefined","document","ontouchstart","xAxis","yAxis","gridLineWidth","legend","enabled","plotOptions","area","marker","radius","lineWidth","states","hover","threshold","series","series_lookup","chartComponent","React","createRef","ref","highcharts","Highcharts","coloured","current","keys","addSeries","data","color","get_colour","latency","get_series","addPoint","BandwidthChart","height","tooltip","headerFormat","pointFormat","tickInterval","categories","floating","width","min","max","tickAmount","reserveSpace","rotation","x","y","labels","stacking","series_name","color_id","Card","Body","Title","prevProps","prevState","snapshot","datum","slice","pop","parseFloat","toFixed","UploadScenario","upload","UP_ENDPOINT","method","body","repeat","headers","ScenarioTable","state","scenarios","normalize_scenarios","scenario_types","TYPE","scenario","editing","sync_table","setState","table_updated","push","normalize_scenario","reindex_scenarios","event","new_scenario","target","value","filter","_","i","s","num","size_formatted","postfix","get_formatted_measurement","update_size","size","Math","floor","label","Table","striped","bordered","responsive","key","Form","Group","controlId","Control","as","defaultValue","onChange","type_changed","colSpan","InputGroup","placeholder","aria-describedby","e","parseInt","Append","Text","style","Button","variant","onClick","edit","delete_row","add","bind","MEASUREMENTS","App","reset_values","ping_timer","populate_scenarios","ping_chart","paused","current_idx","collect_bandwidth_data","Navbar","bg","Brand","href","Container","Row","Col","lg","test_control","xs","md","latest_measurement","latest_bw_measurement","format_title","measurements","direction","check_if_started_and_toggle_pause","current_scenario","pause","cancel_ping","run_scenarios","ping","PING_INTERVAL","run","error","ensure_entry_exists","warn","add_point","interval","json","end","collect_latency","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.6c526522.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App_old is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React, {Component} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\n\n\nexport default class HelloWorldSample extends Component {\n  render() {\n    return (\n      <>\n        <Navbar bg=\"light\">\n          <Navbar.Brand href=\"#\">KNP</Navbar.Brand>\n        </Navbar>\n        <Container>\n          <Row>\n            Hello, World!\n          </Row>\n        </Container>\n      </>\n    );\n  }\n}\n","import React, {Component} from 'react';\n\n\nexport default class MultipleUrlsSample extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <button onClick={this.startDownloadMultipleURLs.bind(this)}>multiple URLs!</button>\n      </div>\n    );\n  }\n\n  convertToMbps(r) {\n    return r*1000/(1<<20)*8;\n  }\n\n  logRate(r) {\n    console.log(`${this.convertToMbps(r).toFixed(2)}Mbps`);\n  }\n\n  async startDownloadMultipleURLs() {\n    let urls = [\n      \"https://worker.arshankhanifar.workers.dev/hey/down\",\n      \"https://speed.cloudflare.com/__down\"\n    ];\n    const bytes = 1 << (20);\n    await this.downloadFromMultipleUrls(bytes, urls);\n  }\n\n  async downloadFromMultipleUrls (bytes, urls) {\n    let requests = urls.map(url => {return {url: url} })\n      .map((req) => {\n        req.start = Date.now();\n        req.fetch = fetch(`${req.url}?bytes=${bytes}`);\n        return req;\n      });\n    await Promise.all(requests.map(req => req.fetch.then(res => res.text().then(t => {\n      req.finish = Date.now();\n    }))));\n    let rates = requests.map(r=>(bytes)/(r.finish - r.start));\n    let total_rate = rates.reduce((a, b) => a + b);\n    this.logRate(total_rate);\n    //return total_rate;\n  }\n\n}\n","import React, {Component} from 'react';\n\n\nexport default class SingleStreamSample extends Component {\n  static get CONFIG() {\n    return \"arshan\";\n    return \"cloudflare\";\n  }\n\n  static get BASE_URL() {\n    return (this.CONFIG === \"arshan\") ?\n      \"https://worker.arshankhanifar.workers.dev\":\n      \"https://speed.cloudflare.com\";\n  }\n  static get DOWN_ENDPOINT() {\n    return (this.CONFIG === \"arshan\") ?\n      \"/hello/down\":\n      \"__down\";\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <button onClick={this.startDownload.bind(this)}>click me!</button>\n      </div>\n    );\n  }\n\n  convertToMbps(r) {\n    return r*1000/(1<<20)*8;\n  }\n\n  logRate(r) {\n    console.log(`${this.convertToMbps(r).toFixed(2)}Mbps`);\n  }\n\n  async download(bytes, streams, url) {\n    let requests = Array(streams)\n      .fill(0)\n      .map(r => {return {}})\n      .map((req) => {\n        req.start = Date.now();\n        req.fetch = fetch(`${url}?bytes=${bytes}`);\n        return req;\n      });\n    await Promise.all(requests.map(req => req.fetch.then(res => res.text().then(t => {\n      req.finish = Date.now();\n    }))));\n    let rates = requests.map(r=>(bytes)/(r.finish - r.start));\n    let total_rate = rates.reduce((a, b) => a + b);\n    this.logRate(total_rate);\n    return total_rate;\n  }\n\n  async startDownload() {\n    let url = `${SingleStreamSample.BASE_URL}/${SingleStreamSample.DOWN_ENDPOINT}`;\n    let test = async (bytes, streams, n) => {\n      let rates = [];\n      for (let i = 0; i < n; i++ ) {\n        rates.push(await this.download(bytes, streams, url));\n      }\n      console.log(`Avg: ${this.convertToMbps(rates.reduce((a, b) => a + b)/rates.length).toFixed(2)}Mbps`)\n    };\n    const bytes = 1 << (24); // 16MB\n    await test(bytes, 6, 1);\n    //await test(bytes, 2, 20);\n  }\n}\n","import React, {Component} from 'react';\nimport Chart from 'chart.js';\nimport './ping_sample.scss';\n\n\nconst INTERVAL_MS = 400;\n\n\nexport default class PingSample extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      measuring: false,\n      latest_measurement: 0\n    };\n    this.timer = null;\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <h1>my chart</h1>\n        <canvas id=\"myChart\" width=\"400\" height=\"400\"/>\n        <br/>\n        <button onClick={this.start.bind(this)}>{this.state.measuring ? 'Pause' : 'Start'}</button>\n        <br/>\n        <span>latency: {this.state.latest_measurement}</span>\n      </div>\n    );\n  }\n\n  start() {\n    if (this.state.measuring) {\n      clearTimeout(this.timer);\n    } else {\n      this.measure(INTERVAL_MS);\n    }\n    this.setState({\n      measuring: !this.state.measuring\n    });\n  }\n\n  measure(interval) {\n    let start = Date.now();\n    fetch(\"https://api.github.com/users/arshankhanifar\")\n      .then(res => res.json())\n      .then(res => {\n        let end = Date.now();\n        console.log(`latency: ${end - start}ms`);\n        let latency = end - start;\n        this.setState({\n          latest_measurement: latency\n        });\n        this.addChartPoint(latency, this.chart.data.labels.length + 1);\n\n      });\n    this.timer = setTimeout(() => this.measure(interval), interval);\n  }\n\n  triggerAddPoint() {\n    this.addChartPoint(Math.random()*10,2);\n  }\n\n  addChartPoint(y, x) {\n    console.log(this.chart.data);\n    this.chart.data.datasets[0].data.push(y);\n    this.chart.data.labels.push(x);\n    this.chart.update();\n  }\n\n  componentDidMount() {\n    this.setState({\n      latest_measurement: 0\n    });\n    this.chart = this.loadChart();\n  }\n\n  loadChart() {\n    var ctx = document.getElementById('myChart').getContext('2d');\n    return new Chart(ctx, {\n      type: 'line',\n      data: {\n        datasets: [{\n          label: \"latency\",\n          backgroundColor: 'rgba(33, 150, 243, 0.8)',\n          data: []\n        }],\n        labels: []\n      },\n      options: {\n        responsive: false,\n        scales: {\n          yAxes: [{\n            ticks: {\n              min: 0\n            }\n          }],\n          xAxes: [{\n            ticks: {\n              min: '1'\n            }\n          }]\n        }\n      }\n    });\n  }\n}\n","import React, {Component} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Button from \"react-bootstrap/Button\";\nimport Highcharts from 'highcharts';\nimport HighchartsReact from 'highcharts-react-official';\n\n\nexport default class HighChartsSample extends Component {\n\n  load_chart_options() {\n    return {\n      chart: {\n        zoomType: 'x'\n      },\n      title: {\n        text: 'USD to EUR exchange rate over time'\n      },\n      subtitle: {\n        text: document.ontouchstart === undefined ?\n          'Click and drag in the plot area to zoom in' : 'Pinch the chart to zoom in'\n      },\n      xAxis: {\n        type: 'datetime'\n      },\n      yAxis: {\n        title: {\n          text: 'Exchange rate'\n        }\n      },\n      legend: {\n        enabled: false\n      },\n      plotOptions: {\n        area: {\n          //fillColor: {\n          //  linearGradient: {\n          //    x1: 0,\n          //    y1: 0,\n          //    x2: 0,\n          //    y2: 1\n          //  },\n          //  stops: [\n          //    [0, Highcharts.getOptions().colors[0]],\n          //    [1, Highcharts.color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]\n          //  ]\n          //},\n          marker: {\n            radius: 2\n          },\n          lineWidth: 1,\n          states: {\n            hover: {\n              lineWidth: 1\n            }\n          },\n          threshold: null\n        }\n      },\n      series: [{\n        type: 'area',\n        name: 'series a',\n        data: []\n      },{\n        type: 'area',\n        name: 'series b',\n        data: []\n      }]\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.chartComponent = React.createRef();\n  }\n\n  render() {\n    return (\n      <>\n        <Navbar bg=\"light\">\n          <Navbar.Brand href=\"#\">KNP</Navbar.Brand>\n        </Navbar>\n        <Container>\n          <Row>\n            <Col>\n              Hello, World!\n              <HighchartsReact\n                ref={this.chartComponent}\n                highcharts={Highcharts}\n                options={this.load_chart_options()}/>\n            </Col>\n          </Row>\n          <Row>\n            <Button onClick={this.redrawChart.bind(this)}>Redraw</Button> {' '}\n            <Button onClick={this.addPoint.bind(this)}>Add Point</Button> {' '}\n          </Row>\n        </Container>\n      </>\n    );\n  }\n\n  addPoint() {\n    const chart = this.chartComponent.current.chart;\n    chart.series[0].addPoint([1514605600000, 2]);\n  }\n\n  redrawChart() {\n    const chart = this.chartComponent.current.chart;\n    chart.redraw();\n  }\n\n  componentDidMount() {\n    const chart = this.chartComponent.current.chart;\n    fetch('https://cdn.jsdelivr.net/gh/highcharts/highcharts@v7.0.0/samples/data/usdeur.json')\n      .then(res => res.json())\n      .then(data => {\n        console.log(this.chartComponent);\n        console.log('data0,100', data.splice(0,100));\n        console.log('data100,200', data.splice(100,100));\n        console.log('data200,300', data.splice(200,100));\n\n        chart.addSeries({\n          type: 'area',\n          name: 'series a',\n          //data: data.splice(0,600)\n          data: data\n        });\n        chart.addSeries({\n          type: 'area',\n          name: 'series b',\n          data: data.splice(100,100)\n        });\n        chart.addSeries({\n          type: 'area',\n          name: 'series c',\n          data: data.splice(200,100)\n        });\n        chart.redraw();\n      })\n  }\n}\n","export default class AppConfiguration {\n  static get CONFIG() {\n    //return \"arshan\";\n    return \"cloudflare\";\n  }\n  static get PING_INTERVAL() {\n    return 100;\n  }\n}","import React, {Component} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Card from \"react-bootstrap/Card\";\nimport Button from \"react-bootstrap/Button\";\nimport Highcharts from 'highcharts';\nimport HighchartsReact from 'highcharts-react-official';\n\n\nexport default class DownloadSpeedChartSample extends Component {\n\n  load_chart_options() {\n    return {\n      chart: {\n        type: 'scatter',\n        height: 150\n      },\n      title: {\n        text: 'Stacked bar chart'\n      },\n      tooltip: {\n        headerFormat: \"\",\n        pointFormat: \"{series.name}: <b>{point.x}</b><br/>\"\n      },\n      xAxis: {\n        tickInterval: 5,\n        categories: []\n      },\n      yAxis: {\n        min: 0.5,\n        max: 1.5,\n        gridLineWidth: 0,\n        tickAmount: 1,\n        title: {\n          text: 'Download speed',\n          rotation: 0,\n        },\n        labels: {\n          enabled: false\n        }\n      },\n      legend: {\n        enabled: false,\n      },\n      plotOptions: {\n        series: {\n          stacking: 'normal'\n        }\n      },\n      series: [{\n        name: 'John',\n        data: [\n          [56.12, 1],\n          [52.12, 1],\n          [34.12, 1],\n          [61.12, 1],\n          [53.12, 1],\n        ]\n      }]\n    }\n\n  }\n\n  constructor(props) {\n    super(props);\n    this.chartComponent = React.createRef();\n  }\n\n  render() {\n    return (\n      <>\n        <Navbar bg=\"light\">\n          <Navbar.Brand href=\"#\">KNP</Navbar.Brand>\n        </Navbar>\n        <Container>\n          <Row>\n            <Col>\n              Hello, World!\n              <Card>\n                <Card.Body>\n                  <HighchartsReact\n                    ref={this.chartComponent}\n                    highcharts={Highcharts}\n                    options={this.load_chart_options()}/>\n\n                </Card.Body>\n              </Card>\n            </Col>\n          </Row>\n          <Row>\n            <Button onClick={this.redrawChart.bind(this)}>Redraw</Button> {' '}\n            <Button onClick={this.addPoint.bind(this)}>Add Point</Button> {' '}\n          </Row>\n        </Container>\n      </>\n    );\n  }\n\n  addPoint() {\n    const chart = this.chartComponent.current.chart;\n    chart.series[0].addPoint([1514605600000, 2]);\n  }\n\n  redrawChart() {\n    const chart = this.chartComponent.current.chart;\n    chart.redraw();\n  }\n\n  componentDidMount() {\n    const chart = this.chartComponent.current.chart;\n    return;\n    fetch('https://cdn.jsdelivr.net/gh/highcharts/highcharts@v7.0.0/samples/data/usdeur.json')\n      .then(res => res.json())\n      .then(data => {\n        console.log(this.chartComponent);\n        console.log('data', data);\n        chart.series[0].setData(data);\n        chart.redraw();\n      })\n  }\n}\n","export default class Scenario {\n  run() {\n    console.log(`running this scenario: ${this.constructor.name}`)\n  }\n\n  pause() {\n    console.log(`pausing this scenario: ${this.constructor.name}`)\n  }\n}\n\n","import Scenario from \"./scenario\";\nimport AppConfiguration from \"../config\";\n\nexport default class BandwidthScenario extends Scenario {\n  static get BASE_URL() {\n    return (AppConfiguration.CONFIG === \"arshan\") ?\n      \"https://worker.arshankhanifar.workers.dev\":\n      \"https://speed.cloudflare.com\";\n  }\n\n  constructor(num_measurements, file_size, num_streams, result_cb) {\n    super();\n    this.num_measurements = num_measurements;\n    this.file_size = file_size;\n    this.counter = 0;\n    this.reset_controller();\n    this.result_callback = result_cb;\n    this.num_streams = num_streams;\n  }\n\n  reset_controller() {\n    this.controller = new AbortController();\n  }\n\n  async run() {\n    super.run();\n    while (this.counter < this.num_measurements) {\n      try {\n        let rate = await this.measure();\n        if (this.result_callback) {\n          this.result_callback(rate);\n        }\n      } catch (e) {\n        console.log(`download: ${this.counter} was cancelled`, e);\n        return false;\n      }\n      this.counter += 1;\n    }\n    return true;\n  }\n\n  pause() {\n    super.pause();\n    this.controller.abort();\n    this.reset_controller();\n  }\n\n  convert_to_mbps(r) {\n    return r*1000/(1<<20)*8;\n  }\n\n  async measure() {\n  }\n}\n\n","import AppConfiguration from \"../config\";\nimport BandwidthScenario from \"./bandwidth_scenario\";\n\nexport default class DownloadScenario extends BandwidthScenario {\n  static get TYPE() {\n    return \"Download\"\n  }\n\n  constructor(...options) {\n    super(...options);\n    this.type = 'Download';\n  }\n\n  static get DOWN_ENDPOINT() {\n    return (AppConfiguration.CONFIG === \"arshan\") ?\n      \"/hello/down\":\n      \"__down\";\n  }\n\n  async measure() {\n    return this.download();\n  }\n\n  async download() {\n    const streams = this.num_streams;\n    const url = `${BandwidthScenario.BASE_URL}/${DownloadScenario.DOWN_ENDPOINT}`;\n    let signal = this.controller.signal;\n    let requests = Array(streams)\n      .fill(0)\n      .map(r => new Object())\n      .map((req) => {\n        req.start = Date.now();\n        req.fetch = fetch(`${url}?bytes=${this.file_size}`, {signal});\n        return req;\n      });\n    await Promise.all(requests.map(req => req.fetch.then(res => res.text().then(t => {\n      req.finish = Date.now();\n    }))));\n    let rates = requests.map(r=>(this.file_size)/(r.finish - r.start));\n    return this.convert_to_mbps(rates.reduce((a, b) => a + b));\n  }\n}\n\n","import Scenario from \"./scenario\";\n\nexport default class WaitScenario extends Scenario {\n  static get TYPE() {\n    return \"Wait\"\n  }\n\n  constructor(duration) {\n    super();\n    this.duration = duration;\n    this.last_start = null;\n    this.type = \"Wait\";\n    this.started = false;\n  }\n\n  async wait(time_ms) {\n    return new Promise(resolve => {\n      this.resolver = resolve;\n      this.last_start = Date.now();\n      this.timer = setTimeout(() => {\n        resolve(true);\n      }, time_ms);\n    });\n  }\n\n  async run() {\n    super.run();\n    if (!this.started) {\n      this.amount_remaining = this.duration;\n      this.started = true;\n    }\n    return await this.wait(this.amount_remaining);\n  }\n\n  pause() {\n    super.pause();\n    clearTimeout(this.timer);\n    this.amount_remaining -= (Date.now() - this.last_start);\n    console.log(`paused, amount remaining: ${this.amount_remaining}`);\n    this.resolver(false);\n  }\n}\n\n\n","import React, {Component} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Button from \"react-bootstrap/Button\";\nimport DownloadScenario from \"../scenarios/download_scenario\";\nimport WaitScenario from \"../scenarios/wait_scenario\";\n\n\nexport default class DownloadScenarioSample extends Component {\n  constructor(props) {\n    super(props);\n    this.create_scenario();\n  }\n\n  render() {\n    return (\n      <>\n        <Navbar bg=\"light\">\n          <Navbar.Brand href=\"#\">KNP</Navbar.Brand>\n        </Navbar>\n        <Container>\n          <Row>\n            <Button onClick={this.start_download.bind(this)}>Start</Button>\n            <Button onClick={this.pause_download.bind(this)}>Pause</Button>\n          </Row>\n        </Container>\n      </>\n    );\n  }\n\n  create_scenario () {\n    this.scenario = new WaitScenario(2*1000);\n    //this.scenario = new DownloadScenario(10, 1<<20, '1MB');\n  }\n\n  async start_download() {\n    if (await this.scenario.run()) {\n      console.log('Finished!');\n    }\n  }\n\n  pause_download() {\n    this.scenario.pause();\n  }\n}\n","export default class ColourProvider {\n  static DEFAULT_COLOURS = [ '#0d233a', '#2f7ed8', '#8bbc21', '#910000', '#1aadce',\n    '#492970', '#f28f43', '#77a1e5', '#c42525', '#a6c96a'];\n  static mapping = {};\n  static count = 0;\n\n  static get_colour(id) {\n    let num_colours = this.DEFAULT_COLOURS.length;\n    if (!(id in this.mapping)) {\n      this.mapping[id] = this.count;\n      this.count += 1 ;\n    }\n    let index = this.mapping[id];\n    return this.DEFAULT_COLOURS[index % num_colours];\n  }\n}\n\n","import React, {Component} from 'react';\nimport Highcharts from 'highcharts';\nimport HighchartsReact from 'highcharts-react-official';\nimport ColourProvider from \"../utilities/colours\";\n\nexport default class PingChart extends Component {\n  chart_options = {\n    chart: {\n      zoomType: 'x',\n      animation: {\n        duration: 100\n      }\n    },\n    title: {\n      text: 'Latency'\n    },\n    subtitle: {\n      text: document.ontouchstart === undefined ?\n        'Click and drag in the plot area to zoom in' : 'Pinch the chart to zoom in'\n    },\n    xAxis: {\n      type: 'datetime'\n    },\n    yAxis: {\n      title: {\n        text: 'Ping(ms)'\n      },\n      gridLineWidth: 0,\n    },\n    legend: {\n      enabled: false\n    },\n    plotOptions: {\n      area: {\n        marker: {\n          radius: 2\n        },\n        lineWidth: 1,\n        states: {\n          hover: {\n            lineWidth: 1\n          }\n        },\n        threshold: null\n      }\n    },\n\n    series: []\n  };\n\n\n  constructor(props) {\n    super(props);\n    this.chartComponent = React.createRef();\n  }\n\n  render() {\n    return (\n      <>\n        <HighchartsReact\n          ref={this.chartComponent}\n          highcharts={Highcharts}\n          options={this.chart_options}/>\n        <br/>\n\n      </>\n    );\n  }\n\n  series_lookup = {};\n\n  get_series(id, coloured) {\n    const chart = this.chartComponent.current.chart;\n    if (!(id in this.series_lookup)) {\n      this.series_lookup[id] = Object.keys(this.series_lookup).length;\n      chart.addSeries({\n        type: 'area',\n        name: 'latency',\n        data: [],\n        color: coloured ? ColourProvider.get_colour(id) : 'rgb(120,120,120)'\n      });\n    }\n    return chart.series[this.series_lookup[id]];\n  }\n\n  add_point(latency, id, coloured) {\n    let series = this.get_series(id, coloured);\n    series.addPoint([Date.now(), latency]);\n  }\n}\n","import React, {Component} from 'react';\nimport Highcharts from 'highcharts';\nimport HighchartsReact from 'highcharts-react-official';\nimport Card from \"react-bootstrap/Card\";\nimport ColourProvider from \"../utilities/colours\";\n\nexport default class BandwidthChart extends Component {\n  chart_options = {\n    chart: {\n      type: 'scatter',\n      height: 100\n    },\n    tooltip: {\n      headerFormat: \"\",\n      pointFormat: \"{series.name}: <b>{point.x}</b><br/>\"\n    },\n    xAxis: {\n      tickInterval: 5,\n      categories: []\n    },\n    title: {\n      floating: true,\n      text: \"\"\n    },\n    yAxis: {\n      width: 0,\n      min: 0.7,\n      max: 1.8,\n      gridLineWidth: 0,\n      tickAmount: 1,\n      title: {\n        reserveSpace: false,\n        text: '',\n        rotation: 0,\n        x: 40,\n        y: -15,\n      },\n      labels: {\n        enabled: false\n      }\n    },\n    legend: {\n      enabled: false,\n    },\n    plotOptions: {\n      series: {\n        stacking: 'normal'\n      }\n    },\n    series: [{\n      name: 'Download Speed',\n      data: [],\n      color: 'red'\n    }]\n  };\n\n  constructor(props) {\n    super(props);\n    this.chartComponent = React.createRef();\n    this.chart_options.series[0] = {\n      name: this.props.series_name,\n      data: [],\n      color: ColourProvider.get_colour(this.props.color_id)\n    }\n  };\n\n  render() {\n    return (\n      <>\n        <Card>\n          <Card.Body>\n            <Card.Title>{this.props.title}</Card.Title>\n            <HighchartsReact\n              ref={this.chartComponent}\n              highcharts={Highcharts}\n              options={this.chart_options}/>\n          </Card.Body>\n        </Card>\n      </>\n    );\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (!prevProps.data) {\n      return;\n    }\n    const datum = prevProps.data.slice(-1).pop();\n    if (!datum) {\n      return;\n    }\n    const chart = this.chartComponent.current.chart;\n    if (chart.series[0].data.length === prevProps.data.length) {\n      return;\n    }\n    chart.series[0].addPoint([parseFloat(datum.rate.toFixed(2)), 1]);\n  }\n}\n","import AppConfiguration from \"../config\";\nimport BandwidthScenario from \"./bandwidth_scenario\";\n\nexport default class UploadScenario extends BandwidthScenario {\n  static get TYPE() {\n    return \"Upload\"\n  }\n\n  constructor(...options) {\n    super(...options);\n    this.type = 'Upload';\n  }\n\n  static get UP_ENDPOINT() {\n    return (AppConfiguration.CONFIG === \"arshan\") ?\n      \"/hello/up\":\n      \"__up\";\n  }\n\n  async measure() {\n    return this.upload();\n  }\n\n  async upload() {\n    const streams = this.num_streams;\n    const url = `${BandwidthScenario.BASE_URL}/${UploadScenario.UP_ENDPOINT}`;\n    let signal = this.controller.signal;\n    let requests = Array(streams)\n      .fill(0)\n      .map(r => new Object())\n      .map((req) => {\n        req.start = Date.now();\n        req.fetch = fetch(`${url}`, {...{\n          method: 'POST',\n          body: '0'.repeat(this.file_size),\n          headers: { 'content-length': this.file_size }\n        }, signal});\n        return req;\n      });\n    await Promise.all(requests.map(req => req.fetch.then(res => res.text().then(t => {\n      req.finish = Date.now();\n    }))));\n    let rates = requests.map(r=>(this.file_size)/(r.finish - r.start));\n    return this.convert_to_mbps(rates.reduce((a, b) => a + b));\n  }\n}\n\n","import React, {Component} from 'react';\nimport Table from \"react-bootstrap/Table\";\nimport Form from \"react-bootstrap/Form\";\nimport InputGroup from \"react-bootstrap/InputGroup\";\nimport Col from 'react-bootstrap/Col';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from \"react-bootstrap/Button\";\nimport DownloadScenario from \"../scenarios/download_scenario\";\nimport UploadScenario from \"../scenarios/upload_scenario\";\nimport WaitScenario from \"../scenarios/wait_scenario\";\n\n\nexport default class ScenarioTable extends Component {\n  async edit(scenario) {\n    let editing = !this.state.scenarios[scenario.id].editing;\n    this.state.scenarios[scenario.id].editing = editing;\n    await this.sync_table();\n  }\n\n  async sync_table(){\n    await this.setState({\n      scenarios: this.state.scenarios\n    });\n    await this.props.table_updated(this.state.scenarios);\n  }\n\n  async add() {\n    this.state.scenarios.push(\n      this.normalize_scenario(new DownloadScenario(20, 1<<17, 1, null))\n    );\n    this.reindex_scenarios();\n    await this.sync_table();\n  }\n\n  async type_changed(scenario, event) {\n    let class_lookup = {\n      [WaitScenario.TYPE]: WaitScenario,\n      [DownloadScenario.TYPE]: DownloadScenario,\n      [UploadScenario.TYPE]: UploadScenario\n    };\n    let new_scenario = new class_lookup[event.target.value]();\n    new_scenario.num_measurements = scenario.num_measurements || 0;\n    new_scenario.num_streams = scenario.num_streams || 0;\n    new_scenario.file_size = scenario.file_size || 0;\n    new_scenario = this.normalize_scenario(new_scenario);\n    new_scenario.editing = true;\n    this.state.scenarios[scenario.id] = new_scenario;\n    await this.reindex_scenarios();\n    await this.sync_table();\n  }\n\n  async delete_row(scenario) {\n    console.log(\"scenario id\", scenario.id);\n    this.state.scenarios = this.state.scenarios.filter((_, i) => i !== scenario.id);\n    this.reindex_scenarios();\n    await this.sync_table();\n  }\n\n  reindex_scenarios() {\n    let count = 0;\n    this.setState({\n      scenarios: this.state.scenarios.map((s) => {\n        s.id = count++;\n        return s;\n      })\n    });\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      scenarios: this.normalize_scenarios(props.scenarios)\n    };\n    this.scenario_types = [\n      DownloadScenario.TYPE,\n      UploadScenario.TYPE,\n      WaitScenario.TYPE\n    ]\n  }\n\n  normalize_scenario(scenario) {\n    let num = scenario.file_size;\n    scenario.size_formatted = (scenario.type === WaitScenario.TYPE)?\n      {value: 0, postfix: \"B\"}:\n      this.get_formatted_measurement(num);\n      this.update_size(scenario);\n    return scenario;\n  }\n\n  normalize_scenarios(scenarios) {\n    return scenarios.map(scenario => {\n      return this.normalize_scenario(scenario);\n    })\n  }\n\n  get_formatted_measurement(size) {\n    if (Math.floor(size/(1<<20)) !== 0) {\n      return {\n        value: size/(1<<20),\n        postfix: \"MB\"\n      };\n    }\n    if (Math.floor(size/(1<<10) !== 0)) {\n      return {\n        value: size/(1<<10),\n        postfix: \"KB\"\n      };\n    }\n    return {\n      value: size,\n      postfix: \"B\"\n    };\n  }\n\n  update_size(scenario) {\n    let value_lookup = {\n      \"KB\": 1<<10,\n      \"MB\": 1<<20,\n      \"B\": 1\n    };\n    scenario.label = `${scenario.size_formatted.value}${scenario.size_formatted.postfix}`;\n    scenario.file_size =\n      value_lookup[scenario.size_formatted.postfix]\n      * scenario.size_formatted.value;\n  }\n\n  render() {\n    return(\n      <>\n        <Table striped bordered responsive>\n          <thead>\n          <tr>\n            <th>#</th>\n            <th>Type</th>\n            <th># Bytes</th>\n            <th># Measurements</th>\n            <th># Streams</th>\n            <th>Delete</th>\n          </tr>\n          </thead>\n          <tbody>\n          {this.state.scenarios.map(scenario => (\n            <tr key={scenario.id}>\n              <td>{scenario.id + 1}</td>\n              { scenario.editing ?\n                (<>\n                  <td>\n                    <Form.Group controlId=\"scenarioType\">\n                      <Form.Control as=\"select\"\n                                    defaultValue={scenario.type}\n                                    onChange={(value)=>{this.type_changed(scenario, value)}}>\n                        {this.scenario_types.map(type =>\n                          <option value={type} key={type}>{type}</option>\n                        )}\n                      </Form.Control>\n                    </Form.Group>\n                  </td>\n                  {\n                    (scenario.type === 'Wait') ?\n                      <>\n                        <td colSpan={3}>\n                          <InputGroup>\n                            <Form.Control\n                              type=\"number\"\n                              placeholder=\"Wait amount (in milliseconds)\"\n                              aria-describedby=\"waitAmount\"\n                              name=\"size\"\n                              onChange={(e)=> {scenario.duration = parseInt(e.target.value)}}\n                              defaultValue={scenario.duration}\n                            />\n                            <InputGroup.Append>\n                              <InputGroup.Text>ms</InputGroup.Text>\n                            </InputGroup.Append>\n                          </InputGroup>\n                        </td>\n                      </> :\n                      <>\n                        <td>\n                          <Form.Group\n                            controlId=\"size\"\n                            style={{width:170}}\n                          >\n                            <InputGroup>\n                              <Form.Control\n                                type=\"number\"\n                                placeholder=\"Size\"\n                                name=\"size\"\n                                defaultValue={scenario.size_formatted.value}\n                                onChange={e => {\n                                  scenario.size_formatted.value = e.target.value;\n                                  this.update_size(scenario);\n                                }}\n                              />\n                              <InputGroup.Append>\n                                <Form.Control\n                                  as=\"select\"\n                                  defaultValue={scenario.size_formatted.postfix}\n                                  onChange={(e)=>{\n                                    scenario.size_formatted.postfix = e.target.value;\n                                    this.update_size(scenario);\n                                  }}>\n                                  {['B', 'KB', 'MB'].map(type =>\n                                    <option value={type} key={type}>{type}</option>\n                                  )}\n                                </Form.Control>\n                              </InputGroup.Append>\n                            </InputGroup>\n                          </Form.Group>\n                        </td>\n                        <td>\n                          <Form.Group\n                            style={{width:100}}\n                          >\n                            <InputGroup>\n                              <Form.Control\n                                type=\"number\"\n                                aria-describedby=\"numberOfMeasurements\"\n                                name=\"num_measurements\"\n                                defaultValue={scenario.num_measurements}\n                                onChange={e => {scenario.num_measurements = parseInt(e.target.value)}}\n                              />\n                            </InputGroup>\n                          </Form.Group>\n                        </td>\n                        <td>\n                          <Form.Group\n                            style={{width:100}}\n                          >\n                            <InputGroup>\n                              <Form.Control\n                                type=\"number\"\n                                aria-describedby=\"numberOfStreams\"\n                                name=\"num_streams\"\n                                defaultValue={scenario.num_streams}\n                                onChange={e => {scenario.num_streams = parseInt(e.target.value)}}\n                              />\n                            </InputGroup>\n                          </Form.Group>\n                        </td>\n                      </>\n                  }\n                </>) :\n                (\n                  <>\n                    {\n                      (scenario.type === 'Wait') ?\n                        <>\n                          <td colSpan={4}>{`${scenario.type} ${scenario.duration}ms`}</td>\n                        </> :\n                        <>\n                          <td>{scenario.type}</td>\n                          <td>{`${scenario.size_formatted.value} ${scenario.size_formatted.postfix}`}</td>\n                          <td>{scenario.num_measurements}</td>\n                          <td>{scenario.num_streams}</td>\n                        </>\n                    }\n                  </>\n                )\n              }\n              <td>\n                <Button variant=\"success\" size=\"sm\" type=\"submit\" onClick={()=>{this.edit(scenario)}}>\n                  {scenario.editing ? 'Done' : 'Edit'}\n                </Button>\n                {' '}\n                <Button variant=\"danger\" size=\"sm\" onClick={() => {this.delete_row(scenario)}}>Delete</Button>\n              </td>\n            </tr>\n          ))}\n          </tbody>\n        </Table>\n        <Button variant=\"success\" onClick={this.add.bind(this)}>Add Row</Button>\n      </>\n    )\n  }\n}\n","import React, {Component} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Container from \"react-bootstrap/Container\";\nimport Col from \"react-bootstrap/Col\";\nimport Row from \"react-bootstrap/Row\";\nimport Button from \"react-bootstrap/Button\";\nimport PingChart from \"./components/ping_chart\";\nimport BandwidthChart from \"./components/bandwidth_chart\";\nimport WaitScenario from \"./scenarios/wait_scenario\";\nimport DownloadScenario from \"./scenarios/download_scenario\";\nimport AppConfiguration from \"./config\";\nimport UploadScenario from \"./scenarios/upload_scenario\";\nimport ScenarioTable from \"./components/scenario_table\";\n\n\nconst MEASUREMENTS = {\n  DOWNLOAD: \"download_measurements\",\n  UPLOAD: \"upload_measurements\",\n};\n\n\nexport default class App extends Component {\n  reset_values() {\n    return {\n      started: false,\n      paused: true,\n      current_idx: 0,\n      [MEASUREMENTS.DOWNLOAD]: {},\n      [MEASUREMENTS.UPLOAD]: {},\n    }\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = this.reset_values();\n    this.ping_timer = null;\n    this.populate_scenarios();\n    this.ping_chart = React.createRef();\n  }\n\n  populate_scenarios() {\n    this.state.scenarios = [\n      new WaitScenario(500),\n      //new DownloadScenario(20, 1<<17, 1, this.collect_bandwidth_data.bind(this)),\n      ////new DownloadScenario(20, 1<<20, 1, this.collect_bandwidth_data.bind(this)),\n      ////new DownloadScenario(20, 10*(1<<20), 1, this.collect_bandwidth_data.bind(this)),\n      //new WaitScenario(500),\n      //new UploadScenario(20, 1<<17, 1, this.collect_bandwidth_data.bind(this)),\n      //new WaitScenario(500),\n      //new UploadScenario(20, 1<<20, 1, this.collect_bandwidth_data.bind(this)),\n      //new UploadScenario(20, 10*(1<<20), 1, this.collect_bandwidth_data.bind(this)),\n      //new WaitScenario(500),\n    ];\n    this.reindex_scenarios();\n  }\n\n  reindex_scenarios() {\n    let count = 0;\n    this.state.scenarios = this.state.scenarios.map((s) => {\n      s.id = count++;\n      return s;\n    });\n  }\n\n  async table_updated(scenarios) {\n    await this.setState({\n      scenarios: scenarios.map(s => {\n        if (s.type !== WaitScenario.TYPE) {\n          s.result_callback = this.collect_bandwidth_data.bind(this)\n        }\n        return s;\n      })\n    });\n  }\n\n  render() {\n    return (\n      <>\n        <Navbar bg=\"light\">\n          <Navbar.Brand href=\"#\">KNP</Navbar.Brand>\n        </Navbar>\n        <Container>\n          <Row>\n            <Col lg={12}>\n              <h1>The Khanifar Bufferbloat Test</h1>\n              <p>Best buffer bloat test in the history of mankind, ever</p>\n            </Col>\n            <Col lg={12}>\n              <h2>Create a scenario</h2>\n              <ScenarioTable\n                scenarios={this.state.scenarios}\n                table_updated={this.table_updated.bind(this)}\n              />\n            </Col>\n            <Col lg={12}>\n              <PingChart\n                ref={this.ping_chart}\n              />\n            </Col>\n            <Col lg={12}>\n              <Button onClick={this.test_control.bind(this)}>{this.state.started ? (this.state.paused ? 'Continue' : 'Pause') : 'Start'}</Button> {' '}\n            </Col>\n            <Col xs={12} md={6}>\n              <span><strong>Download</strong></span>\n            </Col>\n            <Col xs={12} md={6}>\n              <span><strong>Upload</strong></span>\n            </Col>\n            <Col xs={6} md={4}>\n              <span><strong>latency:</strong> {this.state.latest_measurement}</span>\n              <br/>\n              <span><strong>bw:</strong> {this.state.latest_bw_measurement}Mbps</span>\n            </Col>\n          </Row>\n          <Row>\n            <Col xs={12} md={6}>\n              <span><strong>Download Measurements</strong></span>\n              {Object.keys(this.state[MEASUREMENTS.DOWNLOAD]).map(id => (\n                <BandwidthChart key={id}\n                  data={this.state[MEASUREMENTS.DOWNLOAD][id]}\n                  series_name={'Download'}\n                  color_id={id}\n                  title={this.format_title(this.state[MEASUREMENTS.DOWNLOAD][id], 'Download')}\n                />\n              ))}\n            </Col>\n            <Col xs={12} md={6}>\n              <span><strong>Upload Measurements</strong></span>\n              {Object.keys(this.state[MEASUREMENTS.UPLOAD]).map(id => (\n                <BandwidthChart key={id}\n                  data={this.state[MEASUREMENTS.UPLOAD][id]}\n                  series_name={'Upload'}\n                  color_id={id}\n                  title={this.format_title(this.state[MEASUREMENTS.UPLOAD][id], 'Upload')}\n                />\n              ))}\n            </Col>\n          </Row>\n        </Container>\n      </>\n    );\n  }\n\n  format_title(measurements, direction) {\n    if (measurements.length === 0) {\n      return \"Loading...\";\n    }\n    return `${measurements[0].label} ${direction}: (${measurements.length}/${measurements[0].num_measurements})`\n  }\n\n  async check_if_started_and_toggle_pause() {\n    if (!this.state.started) {\n      await this.setState({\n        started: true,\n        paused: false\n      });\n    } else {\n      await this.setState({\n        paused: !this.state.paused\n      });\n    }\n  }\n\n  async test_control() {\n    await this.check_if_started_and_toggle_pause();\n    if (this.state.paused) {\n      if (this.current_scenario) {\n        this.current_scenario.pause();\n      }\n      this.cancel_ping();\n    } else {\n      this.run_scenarios();\n    }\n  }\n\n  async run_scenarios() {\n    if (this.state.current_idx === this.state.scenarios.length) {\n      console.log(\"Scenarios exhausted\");\n      return;\n    }\n    this.ping(AppConfiguration.PING_INTERVAL);\n    this.current_scenario = this.state.scenarios[this.state.current_idx];\n    while(await this.current_scenario.run()) {\n      await this.setState({\n        current_idx: (this.state.current_idx + 1)\n      });\n      if (this.state.current_idx === this.state.scenarios.length) {\n        console.log(\"Scenarios finished\");\n        this.cancel_ping();\n        return;\n      }\n      this.current_scenario = this.state.scenarios[this.state.current_idx];\n    }\n  }\n\n  async collect_bandwidth_data(rate) {\n    if (this.current_scenario.type === WaitScenario.TYPE){\n      console.error(\"Received rate from a WaitScenario\", rate);\n      return;\n    }\n    await this.ensure_entry_exists();\n    let scenario = this.current_scenario;\n    let measurements = (scenario.type ===  DownloadScenario.TYPE) ?\n      MEASUREMENTS.DOWNLOAD : MEASUREMENTS.UPLOAD;\n    this.state[measurements][scenario.id].push({\n      ...scenario,\n      rate: rate\n    });\n    await this.setState({\n      [measurements]: this.state[measurements]\n    });\n    console.log(\"received download data\", rate);\n  }\n\n  async ensure_entry_exists() {\n    let scenario = this.current_scenario;\n    let measurements = (scenario.type ===  DownloadScenario.TYPE) ?\n      MEASUREMENTS.DOWNLOAD : MEASUREMENTS.UPLOAD;\n    if (!(scenario.id in this.state[measurements])) {\n      this.state[measurements][scenario.id] = [];\n      await this.setState({\n        [measurements]: this.state[measurements]\n      });\n    }\n  }\n\n  collect_latency(latency) {\n    if (this.state.paused) {\n      console.warn(\"Skipping latency Measurement cuz paused...\");\n      return;\n    }\n    console.log('latency', latency);\n    this.setState({\n      latest_measurement: latency\n    });\n\n    this.ping_chart.current.add_point(\n      latency,\n      this.current_scenario.id,\n      (this.current_scenario.type !== WaitScenario.TYPE)\n    );\n  }\n\n  async ping(interval) {\n    let start = Date.now();\n    fetch(\"https://api.github.com/users/arshankhanifar\")\n      .then(res => res.json())\n      .then(async res => {\n        let end = Date.now();\n        let latency = end - start;\n        this.collect_latency(latency);\n      });\n    this.ping_timer = setTimeout(() => this.ping(interval), interval);\n  }\n\n  cancel_ping() {\n    clearTimeout(this.ping_timer);\n    this.ping_timer = null;\n  }\n\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport HelloWorldSample from \"./samples/hello_world_sample\";\nimport MultipleUrlsSample from \"./samples/multiple_urls_sample\";\nimport SingleStreamSample from \"./samples/single_stream_sample\";\nimport PingSample from \"./samples/ping_sample\";\nimport HighChartsSample from \"./samples/highcharts_sample\";\nimport DownloadSpeedChartSample from \"./samples/download_speed_chart_sample\";\nimport DownloadScenarioSample from \"./samples/scenario_sample\";\nimport App from \"./app\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}